<div class="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-4xl mx-auto">
    <div class="text-center mb-8">
      <h1 class="text-3xl font-extrabold text-gray-900">Create your PropertyPulse Account</h1>
      <p class="mt-2 text-lg text-gray-600">Join our community of property managers and tenants</p>
    </div>

    <!-- Progress Bar -->
    <div class="mb-8">
      <div class="flex justify-between items-center">
        <div class="text-sm text-gray-500">Step {{ currentStep }} of {{ totalSteps }}</div>
        <!-- <div class="text-sm text-gray-500">{{ Math.round((currentStep / totalSteps) * 100) }}% Complete</div> -->
      </div>
      <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
        <div 
          class="bg-blue-600 h-2.5 rounded-full transition-all duration-500 ease-in-out" 
          [style.width]="(currentStep / totalSteps) * 100 + '%'"
        ></div>
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
      <strong>Error:</strong> {{ errorMessage }}
    </div>

    <!-- Registration Form Steps -->
    <div class="bg-white rounded-lg shadow p-8">
      <!-- Step 1: User Type Selection -->
      <div *ngIf="currentStep === 1">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">I am registering as a:</h2>
        
        <form [formGroup]="userTypeForm" class="space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div 
              (click)="userTypeForm.get('userType')?.setValue('tenant')"
              [ngClass]="{
                'border-blue-500 ring-2 ring-blue-200': userTypeForm.get('userType')?.value === 'tenant',
                'border-gray-200': userTypeForm.get('userType')?.value !== 'tenant'
              }"
              class="border rounded-lg p-6 cursor-pointer transition duration-200 ease-in-out hover:border-blue-300"
            >
              <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                  <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                    <span class="material-icons text-blue-600">person</span>
                  </div>
                  <h3 class="text-xl font-semibold">Tenant</h3>
                </div>
                <div 
                  [ngClass]="{
                    'bg-blue-500': userTypeForm.get('userType')?.value === 'tenant',
                    'bg-gray-200': userTypeForm.get('userType')?.value !== 'tenant'
                  }"
                  class="w-6 h-6 rounded-full border-2 border-white flex items-center justify-center"
                >
                  <span *ngIf="userTypeForm.get('userType')?.value === 'tenant'" class="material-icons text-white text-sm">check</span>
                </div>
              </div>
              <p class="text-gray-600">Register as a tenant to pay rent, submit maintenance requests, and communicate with your property manager.</p>
            </div>

            <div 
              (click)="userTypeForm.get('userType')?.setValue('landlord')"
              [ngClass]="{
                'border-blue-500 ring-2 ring-blue-200': userTypeForm.get('userType')?.value === 'landlord',
                'border-gray-200': userTypeForm.get('userType')?.value !== 'landlord'
              }"
              class="border rounded-lg p-6 cursor-pointer transition duration-200 ease-in-out hover:border-blue-300"
            >
              <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                  <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                    <span class="material-icons text-blue-600">business</span>
                  </div>
                  <h3 class="text-xl font-semibold">Landlord</h3>
                </div>
                <div 
                  [ngClass]="{
                    'bg-blue-500': userTypeForm.get('userType')?.value === 'landlord',
                    'bg-gray-200': userTypeForm.get('userType')?.value !== 'landlord'
                  }"
                  class="w-6 h-6 rounded-full border-2 border-white flex items-center justify-center"
                >
                  <span *ngIf="userTypeForm.get('userType')?.value === 'landlord'" class="material-icons text-white text-sm">check</span>
                </div>
              </div>
              <p class="text-gray-600">Register as a landlord to manage your properties, collect payments, and communicate with tenants.</p>
            </div>
          </div>
        </form>
      </div>

      <!-- Step 2: Account Details -->
      <div *ngIf="currentStep === 2">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">Create your account</h2>
        
        <form [formGroup]="accountDetailsForm" class="space-y-6">
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
            <input 
              type="email" 
              id="email" 
              formControlName="email" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
              placeholder="your.email@example.com"
            >
            <div *ngIf="accountDetailsForm.get('email')?.invalid && accountDetailsForm.get('email')?.touched" class="text-red-500 text-sm mt-1">
              <span *ngIf="accountDetailsForm.get('email')?.errors?.['required']">Email is required</span>
              <span *ngIf="accountDetailsForm.get('email')?.errors?.['email']">Please enter a valid email address</span>
            </div>
          </div>

          <div>
            <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
            <input 
              type="password" 
              id="password" 
              formControlName="password" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
              placeholder="••••••••"
            >
            <div *ngIf="accountDetailsForm.get('password')?.invalid && accountDetailsForm.get('password')?.touched" class="text-red-500 text-sm mt-1">
              <span *ngIf="accountDetailsForm.get('password')?.errors?.['required']">Password is required</span>
              <span *ngIf="accountDetailsForm.get('password')?.errors?.['minlength']">Password must be at least 8 characters</span>
            </div>
          </div>

          <div>
            <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
            <input 
              type="password" 
              id="confirmPassword" 
              formControlName="confirmPassword" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
              placeholder="••••••••"
            >
            <div *ngIf="accountDetailsForm.get('confirmPassword')?.invalid && accountDetailsForm.get('confirmPassword')?.touched" class="text-red-500 text-sm mt-1">
              <span *ngIf="accountDetailsForm.get('confirmPassword')?.errors?.['required']">Please confirm your password</span>
              <span *ngIf="accountDetailsForm.get('confirmPassword')?.errors?.['passwordMismatch']">Passwords don't match</span>
            </div>
          </div>
        </form>
      </div>

      <!-- Step 3: Profile Details -->
      <div *ngIf="currentStep === 3">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">Your profile information</h2>
        
        <form [formGroup]="profileDetailsForm" class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
              <input 
                type="text" 
                id="firstName" 
                formControlName="firstName" 
                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                placeholder="John"
              >
              <div *ngIf="profileDetailsForm.get('firstName')?.invalid && profileDetailsForm.get('firstName')?.touched" class="text-red-500 text-sm mt-1">
                First name is required
              </div>
            </div>

            <div>
              <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
              <input 
                type="text" 
                id="lastName" 
                formControlName="lastName" 
                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                placeholder="Doe"
              >
              <div *ngIf="profileDetailsForm.get('lastName')?.invalid && profileDetailsForm.get('lastName')?.touched" class="text-red-500 text-sm mt-1">
                Last name is required
              </div>
            </div>
          </div>

          <div>
            <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
            <input 
              type="tel" 
              id="phone" 
              formControlName="phone" 
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
              placeholder="(123) 456-7890"
            >
            <div *ngIf="profileDetailsForm.get('phone')?.invalid && profileDetailsForm.get('phone')?.touched" class="text-red-500 text-sm mt-1">
              Phone number is required
            </div>
          </div>

          <!-- Landlord specific fields -->
          <div *ngIf="userType === 'landlord'" class="space-y-6">
            <div>
              <label for="companyName" class="block text-sm font-medium text-gray-700 mb-1">Company Name (Optional)</label>
              <input 
                type="text" 
                id="companyName" 
                formControlName="companyName" 
                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                placeholder="Your Company LLC"
              >
            </div>

            <div formGroupName="address" class="space-y-4">
              <h3 class="text-lg font-medium text-gray-800">Business Address</h3>
              
              <div>
                <label for="street" class="block text-sm font-medium text-gray-700 mb-1">Street Address</label>
                <input 
                  type="text" 
                  id="street" 
                  formControlName="street" 
                  class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                  placeholder="123 Main St"
                >
              </div>

              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label for="city" class="block text-sm font-medium text-gray-700 mb-1">City</label>
                  <input 
                    type="text" 
                    id="city" 
                    formControlName="city" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="New York"
                  >
                </div>

                <div>
                  <label for="state" class="block text-sm font-medium text-gray-700 mb-1">State</label>
                  <input 
                    type="text" 
                    id="state" 
                    formControlName="state" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="NY"
                  >
                </div>

                <div>
                  <label for="zipCode" class="block text-sm font-medium text-gray-700 mb-1">ZIP Code</label>
                  <input 
                    type="text" 
                    id="zipCode" 
                    formControlName="zipCode" 
                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                    placeholder="10001"
                  >
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>

      <!-- Step 4: Subscription Plan (Landlord Only) -->
      <div *ngIf="currentStep === 4 && userType === 'landlord'">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">Choose your subscription plan</h2>
        
        <form [formGroup]="subscriptionForm" class="space-y-6">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div *ngFor="let plan of subscriptionPlans"
                [ngClass]="{'ring-2 ring-blue-500': selectedPlan === plan.id}"
                class="border rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-200"
            >
              <div 
                [ngClass]="{
                  'bg-white border-b': !plan.recommended,
                  'bg-blue-50 border-b border-blue-100': plan.recommended
                }"
                class="p-6"
              >
                <!-- Recommended badge -->
                <div *ngIf="plan.recommended" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mb-2">
                  Recommended
                </div>
                
                <h3 class="text-lg font-semibold mb-2">{{ plan.name }}</h3>
                <div class="text-gray-900 mb-2">
                  <span class="text-2xl font-bold">${{ plan.price }}</span>
                  <span class="text-gray-500">/{{ plan.billingPeriod }}</span>
                </div>
                
                <button 
                  type="button"
                  (click)="selectPlan(plan.id)"
                  [ngClass]="{ 
                    'bg-blue-600 text-white hover:bg-blue-700': selectedPlan === plan.id,
                    'bg-white text-blue-600 border border-blue-600 hover:bg-blue-50': selectedPlan !== plan.id
                  }"
                  class="w-full mt-3 px-4 py-2 rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"
                >
                  {{ selectedPlan === plan.id ? 'Selected' : 'Select' }}
                </button>
              </div>
              
              <div class="p-6 bg-gray-50 h-full">
                <ul class="space-y-3">
                  <li *ngFor="let feature of plan.features" class="flex">
                    <span class="material-icons text-green-500 mr-2">check_circle</span>
                    <span>{{ feature }}</span>
                  </li>
                  
                  <li *ngFor="let limitation of plan.limitations" class="flex">
                    <span class="material-icons text-red-500 mr-2">cancel</span>
                    <span>{{ limitation }}</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          
          <div class="mt-4 text-sm text-gray-500">
            <p>
              <span class="material-icons text-sm align-middle">lock</span>
              Secure payment processing through Stripe. Your payment information is never stored on our servers.
            </p>
          </div>
        </form>
      </div>

      <!-- Navigation Buttons -->
      <div class="flex justify-between mt-8">
        <button 
          *ngIf="currentStep > 1"
          (click)="prevStep()" 
          type="button"
          class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"
        >
          <span class="material-icons mr-1 align-middle">arrow_back</span>
          Back
        </button>
        <div *ngIf="currentStep === 1"></div>
        
        <div>
          <button 
            (click)="nextStep()" 
            type="button"
            [disabled]="isLoading"
            [ngClass]="{
              'opacity-50 cursor-not-allowed': isLoading
            }"
            class="px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"
          >
            <span *ngIf="isLoading" class="inline-block animate-spin h-4 w-4 border-2 border-t-transparent border-white rounded-full mr-2"></span>
            {{ (currentStep === totalSteps || (currentStep === 3 && userType === 'tenant')) ? 'Complete Registration' : 'Continue' }}
            <span *ngIf="currentStep < totalSteps && !(currentStep === 3 && userType === 'tenant')" class="material-icons ml-1 align-middle">arrow_forward</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Sign In Link -->
    <div class="text-center mt-6">
      <p class="text-gray-600">
        Already have an account? 
        <a routerLink="/login" class="text-blue-600 hover:text-blue-800 font-medium">Sign in</a>
      </p>
    </div>
  </div>
</div>
